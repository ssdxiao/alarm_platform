<html>
<head>
    <title>监控告警后台管理系统</title>
    <meta charset="UTF-8">
    <link href="/static/css/bootstrap-combined.min.css" rel="stylesheet">
    <link href="/static/css/all.css" rel="stylesheet">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/jquery.i18n.properties-1.0.9.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/api.js"></script>
    <script src="/static/js/custumer.js"></script>
    <script src="/static/js/canada.js"></script>
    <script src="/static/js/alarm.js"></script>
    <script src="/static/js/manage.js"></script>
    <script src="/static/js/record.js"></script>
    <script src="/static/js/ajaxfileupload.js"></script>
    <script type="text/javascript">

        function load() {
           loadProperties(function (){
                $('title').html($.i18n.prop('title'));
                $('.self_foot div span').html($.i18n.prop('footer'));
                $(".btn-close").html($.i18n.prop('close')) 
                alarm_string = new Array();
                alarm_string[0] = $.i18n.prop('undeal');
                alarm_string[1] = $.i18n.prop('deal');
                alarm_string[2] = $.i18n.prop('deal_complete');
                alarm_string[3] = $.i18n.prop('other_deal');
                string_upload = $.i18n.prop('upload')
                telephone=$.i18n.prop('telephone');
                telephoneing=$.i18n.prop('telephoneing');
                record_file=$.i18n.prop('record_file');
                hungup=$.i18n.prop('hungup');
                check_phone_server_start=$.i18n.prop('check_phone_server_start');
                uploadfile_unmatch=$.i18n.prop('uploadfile_unmatch');
                temporary_logout_nosave=$.i18n.prop('temporary_logout_nosave');
                please_add_https=$.i18n.prop('please_add_https');
                here=$.i18n.prop('here');
                new_alarm=$.i18n.prop('new_alarm');
                please_check=$.i18n.prop('please_check');

                //$(".self_title h2").html($.i18n.prop('title'));
                $(".self_title h4 span").html($.i18n.prop('welcome'));
                $("#logout_index").html($.i18n.prop('logout'));
                $("#alarm_list").html($.i18n.prop('alarm_list')) 
                $("#custumer_list").html($.i18n.prop('custumer_list')) 
                $("#record_list").html($.i18n.prop('record_list')) 
                $("#manage_list").html($.i18n.prop('manage_list')) 
                $("#alarm_table tr th").eq(0).html($.i18n.prop('event_id'))
                $("#alarm_table tr th").eq(1).html($.i18n.prop('event_time'))
                $("#alarm_table tr th").eq(2).html($.i18n.prop('event_detail'))
                $("#alarm_table tr th").eq(3).html($.i18n.prop('proccessing_status'))
                $("#alarm_table tr th").eq(4).html($.i18n.prop('responsible_staff'))
                $("#alarmAlert strong span").html($.i18n.prop('caution')) 
                $("#alarmAlert strong span").html($.i18n.prop('caution')) 
                $("#alarm_title").text($.i18n.prop('warning_detail')) 
                $("#alarm_id").html($.i18n.prop('alarm_id')) 
                $("#alarm_dev").html($.i18n.prop('alarm_device')) 
                $("#deal_person").html($.i18n.prop('deal_person')) 
                $("#deal_progress_lable").html($.i18n.prop('deal_progress_lable')) 
                
                $("#modal_alarm_table tr th").eq(0).html($.i18n.prop('event_id'))
                $("#modal_alarm_table tr th").eq(1).html($.i18n.prop('event_type'))
                $("#modal_alarm_table tr th").eq(2).html($.i18n.prop('event_time'))
                $("#modal_alarm_table tr th").eq(3).html($.i18n.prop('event_detail'))
                $("#user_label").html($.i18n.prop('user'))
                $("#addr_label").html($.i18n.prop('address'))
                $("#remark_label").html($.i18n.prop('remark'))

                $("#alarm_table_other tr th").eq(0).html($.i18n.prop('name'))
                $("#alarm_table_other tr th").eq(1).html($.i18n.prop('pass_code'))
                $("#alarm_table_other tr th").eq(2).html($.i18n.prop('home_phone'))
                $("#alarm_table_other tr th").eq(3).html($.i18n.prop('worker_phone'))
                $("#alarm_table_other tr th").eq(4).html($.i18n.prop('cell_phone'))
                $("#alarm_deal_progress_table tr th").eq(0).html($.i18n.prop('staff_of_proccessed'))
                $("#alarm_deal_progress_table tr th").eq(1).html($.i18n.prop('phone_of_proccessed'))
                $("#alarm_deal_progress_table tr th").eq(2).html($.i18n.prop('proccessed_time'))
                $("#alarm_deal_progress_table tr th").eq(3).html($.i18n.prop('proccesse_detail'))
                $("#alarm_deal_progress_table tr th").eq(4).html($.i18n.prop('attachment'))
                $("#deal_alarm_ok").html($.i18n.prop('deal_ok'))
                $("#temporary_pause").html($.i18n.prop('temporary_pause'))

                $("#modal_custumer_detail .modal-header h3").html($.i18n.prop('custom_detail'))
                $("[for=inputCustumerIdDetail]").html($.i18n.prop('custom_id'))
                $("[for=inputCustumerNameDetail]").html($.i18n.prop('custom_name'))
                $("[for=inputCustumerTelephoneDetail]").html($.i18n.prop('custom_phone'))
                $("[for=inputCustumerEmailDetail]").html($.i18n.prop('custom_email'))
                $("[for=inputCustumerDeviceidDetail]").html($.i18n.prop('device_id'))
                $("[for=inputCustumerPhoneDetail]").html($.i18n.prop('landline_number'))
                $("[for=inputCustumerStateDetail]").html($.i18n.prop('state'))
                $("[for=inputCustumerCityDetail]").html($.i18n.prop('city'))
                $("[for=inputCustumerStreetDetail]").html($.i18n.prop('addr'))
                $("[for=inputCustumerPostelCodeDetail]").html($.i18n.prop('zip_code'))
                $("[for=inputCustumerRemarkDetail]").html($.i18n.prop('remark_'))
                $("#modal_custumer_detail .modal-body p").html($.i18n.prop('custumer_tips'))
                
                $("#leave_time").val($.i18n.prop('leave_time'))
                $("#arrive_time").val($.i18n.prop('arrive_time'))
                $("#Mon").html($.i18n.prop('Mon'))
                $("#Tue").html($.i18n.prop('Tue'))
                $("#Wed").html($.i18n.prop('Wed'))
                $("#Thu").html($.i18n.prop('Thu'))
                $("#Fri").html($.i18n.prop('Fri'))
                $("#Sat").html($.i18n.prop('Sat'))
                $("#Sun").html($.i18n.prop('Sun'))
                $("#Hol").html($.i18n.prop('Hol'))

                $("#custumer_table_detail tr th").eq(0).html($.i18n.prop('name'))
                $("#custumer_table_detail tr th").eq(1).html($.i18n.prop('pass_code'))
                $("#custumer_table_detail tr th").eq(2).html($.i18n.prop('home_phone'))
                $("#custumer_table_detail tr th").eq(3).html($.i18n.prop('worker_phone'))
                $("#custumer_table_detail tr th").eq(4).html($.i18n.prop('cell_phone'))
                
                $("#custumer_add_other").html($.i18n.prop('add'))
                $("#update_custumer_modal").html($.i18n.prop('modify'))

                $("#modal_add_custumer .modal-header h3").html($.i18n.prop('new_custom'))
                $("[for=inputCustumerName]").html($.i18n.prop('custom_name'))
                $("[for=inputCustumerTelephone]").html($.i18n.prop('custom_phone'))
                $("[for=inputCustumerEmail]").html($.i18n.prop('custom_email'))
                $("[for=inputCustumerDeviceidDetail]").html($.i18n.prop('device_id'))
                $("[for=inputCustumerDeviceid]").html($.i18n.prop('device_id'))
                $("[for=inputCustumerRemark]").html($.i18n.prop('remark_'))
                $("#add_custumer_modal").html($.i18n.prop('add'))
                $("#add_custumer").html($.i18n.prop('new_custom'))
                
                $("#custumer_table tr th").eq(0).html($.i18n.prop('custom_id'))
                $("#custumer_table tr th").eq(1).html($.i18n.prop('custom_name'))
                $("#custumer_table tr th").eq(2).html($.i18n.prop('custom_phone'))
                $("#custumer_table tr th").eq(3).html($.i18n.prop('device_id'))

                $("#record_table tr th").eq(0).html($.i18n.prop('journal_id'))
                $("#record_table tr th").eq(1).html($.i18n.prop('operator'))
                $("#record_table tr th").eq(2).html($.i18n.prop('object'))
                $("#record_table tr th").eq(3).html($.i18n.prop('detail'))
                $("#record_table tr th").eq(4).html($.i18n.prop('time'))

                $("#modal_change_passwd .modal-header h3").html($.i18n.prop('change_password'))
                $("[for=inputManagePasswdDetail]").html($.i18n.prop('admin_password'))
                $("#update_change_modal").html($.i18n.prop('modify'))
                
                $("#modal_manage_detail .modal-header h3").html($.i18n.prop('admin_detail'))
                $("[for=inputManageIdDetail]").html($.i18n.prop('admin_id'))
                $("[for=inputManageNameDetail]").html($.i18n.prop('admin_name'))
                $("[for=inputManageTelephoneDetail]").html($.i18n.prop('admin_phone'))
                $("#change_passwd").html($.i18n.prop('change_password'))
                $("#update_manage_modal").html($.i18n.prop('modify'))

                $("#modal_add_manage .modal-header h3").html($.i18n.prop('add_admin'))
                $("[for=inputManageName]").html($.i18n.prop('admin_name'))
                $("[for=inputManageTelephone]").html($.i18n.prop('admin_phone'))
                $("[for=inputManagePassword]").html($.i18n.prop('admin_password'))
                $("#add_manage_modal").html($.i18n.prop('add'))
                $("#add_manage").html($.i18n.prop('add_admin'))
                $("#manage_table tr th").eq(0).html($.i18n.prop('admin_id'))
                $("#manage_table tr th").eq(1).html($.i18n.prop('admin_name'))
                $("#manage_table tr th").eq(2).html($.i18n.prop('admin_phone'))
                $("#manage_table tr th").eq(3).html($.i18n.prop('last_time_login'))
                $("#manage_table tr th").eq(4).html($.i18n.prop('last_time_logout'))
                
                $("#modal_alarm_deal .modal-header h3").html($.i18n.prop('event_proccess'))
                $("#hungup").html($.i18n.prop('hungup'))
                $("[for=alarmRemark]").html($.i18n.prop('proccessed_record'))
                $("#alarm_deal_commit").html($.i18n.prop('commit'))
                $("#alarm_deal_cancel").html($.i18n.prop('temporary_pause'))

                $("#modal_upload .modal-header h3").html($.i18n.prop('upload'))
                $("#select").html($.i18n.prop('user'))
                $("#upload_commit").html($.i18n.prop('commit'))

          })

            var value = getCookie("user");
            console.log(value);
            if (value) {
                var data = JSON.parse(value);
                console.log(data.user + " is login" + " " + data.token);
                if (typeof(data.user) != "undefined") {
                    $('#login_index').attr('style', 'display:none');
                    $("#manage_index").text(data.user);


                    if (data.user == "admin") {
                        $("#manage_list").attr("style", "display:''")
                    }
                    else {
                        var ws = new WebSocket("wss://" + window.location.hostname + ":9001/server/realtime");
                        ws.onerror = function (e) {
                            console.log(e);
                             $("#alarm_message").text("未知错误")
                            $("#alarmAlert").attr('style', "display:''");

                        };

                        ws.onopen = function () {
                            console.log("Openened connection to websocket");
                            ws.send(value)
                           // $("#alarm_message").text("请访问https://"+window.location.hostname + ":9001/https_verify")

                        };
                        ws.onclose = function () {
                            console.log("Close connection to websocket");
                            $("#alarm_message").text(please_add_https)
                            $("#alarm_message").append(" "+"<a href=https://"+window.location.hostname + ":9001/https_verify>"+here+"</a>")
                            $("#alarmAlert").attr('style', "display:''");
                        };
                        ws.onmessage = function (e) {
                            console.log("websocket recv message")
                            var data = JSON.parse(e.data);
                            console.log(data)
                            if (data.type == "alarm" ){
                            $("#alarm_message").text(new_alarm+data.num+please_check)
                            $("#alarmAlert").attr('style', "display:''")
                            get_alarm_list_refresh(1)
                            }
                            else if (data.type == "fresh_alarm")
                            {
                                     get_alarm_list_refresh(1)
                             }
       

                        }


                    }
                    get_alarm_list_refresh(1)
                    return

                }

            }

            console.log("no user login")
            document.location = "/static/login.html"
            //$('#login_index').trigger("click")


        }

        $(function () {

$('#modal_alarm_deal').on('hidden.bs.modal', function () {
  do_hangup(function (data) {
                    console.log("call do_hangup")
                    console.log(data)
                    if(data.msg !="OK"){
                        alert(data.msg)
                    }

                })

    
})           

           $('#alarm_deal_cancel').click(function (e) {
            var id = e.currentTarget.id
            console.log(id)
            var ret = confirm(temporary_logout_nosave)
             if (ret==true)
    {
           return true
    }
  else
    {
           return false
    }
            })
   
            $("#alarm_close").click(function (e) {
                $("#alarmAlert").attr('style', "display:none")
            })
            $('#login_example').click(function (e) {
                $("#message_modal_login").text("");
                login($("#inputUser").val(),
                        $("#inputPassword").val(),
                        function (data) {
                            var result = JSON.parse(data);
                            console.log(result);
                            if (result.result == "error") {
                                $("#message_modal_login").text("用户名或者密码错误！")
                            }
                            else {
                                $('#modal_login').modal('hide');
                                //登陆成功以后 开始获取相关参数并刷新界面
                                /*
                                 $('#login_index').attr('style', 'display:none');
                                 $("#manage_index").text("欢迎 " + result.user);
                                 $("#title").attr("style", "display:''");
                                 */
                                delCookie("user");
                                setCookie("user", data);
                                location.reload()


                            }
                        });
                // Don't let the link do its natural thing
                e.preventDefault()
            });
            $('#logout_index').click(function () {
                var value = getCookie("user");
                if (value) {
                    var data = JSON.parse(value);
                    logout(data.user, data.token)
                }
                delCookie("user");
                location.reload()


            })


//-----------------------custumer function -------------------------------//
            $('#add_custumer_modal').click(function (e) {
                var deviceid = $("#inputCustumerDeviceid").val()
                if (deviceid.length !=20)
{
   alert("请检查绑定设备id")
return
}
                add_custumer($("#inputCustumerName").val(),
                        $("#inputCustumerTelephone").val(),
                        $("#inputCustumerEmail").val(),
                        $("#inputCustumerRemark").val(),
                        $("#inputCustumerDeviceid").val(),
                        
                        function (data) {
                            var result = JSON.parse(data);
                            console.log(result);
                            if (result.result == "error") {
                                $("#message_modal_custumer").text("增加用户失败")
                            }
                            else {
                                $('#modal_add_custumer').modal('hide');
                                //重新刷新用户列表
                                $("#inputCustumerName").val("")
                        $("#inputCustumerTelephone").val("")
                        $("#inputCustumerEmail").val("")
                        $("#inputCustumerRemark").val("")
                        $("#inputCustumerDeviceid").val("")

                                var index = window.current_page
                                get_custumer_list_refresh(index);

                            }
                        });
                // Don't let the link do its natural thing
                e.preventDefault()
            });

            $("#custumer_add_other").click(function (e) {
                var data = {}
                data.name = "";
                data.token = "";
                data.famliyphone = "";
                data.workphone = "";
                data.telphone = "";
                insert_to_custumer_detail_table(data)

            });


            $("#update_custumer_modal").click(function (e) {
                var data = {}
                data.CustumerId = $("#inputCustumerIdDetail").val();
                data.CustumerName = $("#inputCustumerNameDetail").val();
                data.CustumerTelephone = $("#inputCustumerTelephoneDetail").val();
                data.CustumerEmail = $("#inputCustumerEmailDetail").val();
                data.CustumerRemark = $("#inputCustumerRemarkDetail").val();
                data.other = new Array()
                data.CustumerDeviceid = $("#inputCustumerDeviceidDetail").val();
                data.CustumerPhone = $("#inputCustumerPhoneDetail").val();
                data.CustumerState = $("#inputCustumerStateDetail").val();
                data.CustumerCity= $("#inputCustumerCityDetail").val();
                data.CustumerStreet = $("#inputCustumerStreetDetail").val();
                data.CustumerPostelCode = $("#inputCustumerPostelCodeDetail").val();
                data.Monleave = $("#Monleave").val();
                data.Monreturn = $("#Monreturn").val();
                data.Tueleave = $("#Tueleave").val();
                data.Tuereturn = $("#Tuereturn").val();
                data.Wedleave = $("#Wedleave").val();
                data.Wedreturn = $("#Wedreturn").val();
                data.Thuleave = $("#Thuleave").val();
                data.Thureturn = $("#Thureturn").val();
                data.Frileave = $("#Frileave").val();
                data.Frireturn = $("#Frireturn").val();
                data.Satleave = $("#Satleave").val();
                data.Satreturn = $("#Satreturn").val();
                data.Sunleave = $("#Sunleave").val();
                data.Sunreturn = $("#Sunreturn").val();
                data.Holleave = $("#Holleave").val();
                data.Holreturn = $("#Holreturn").val();

                if (typeof(data.CustumerCity) == "undefined"){
                     data.CustumerCity = 0

                }
                 if (typeof(data.CustumerState) == "undefined"){
                     data.CustumerState = 0

                }


                //获取other元素
                $("#custumer_table_detail tbody tr").each(function () {
                    var other = {}
                    $(this).find("td input").each(function () {
                        if ($(this).attr("name") == "name") {
                            other.name = $(this).val();
                        }
                        else if ($(this).attr("name") == "token") {
                            other.token = $(this).val();
                        }
                        else if ($(this).attr("name") == "famliyphone") {
                            other.famliyphone = $(this).val();
                        }
                        else if ($(this).attr("name") == "workphone") {
                            other.workphone = $(this).val();
                        }
                        else if ($(this).attr("name") == "telphone") {
                            other.telphone = $(this).val();
                        }

                    });
                    if (other.name) {
                        data.other.push(other)
                    }
                })

                console.log(data)
                //发送信息
                update_custumer(data, function (data) {
                    var result = JSON.parse(data);
                    console.log(result);
                    if (result.result == "error") {
                        console.log("更新用户失败")
                    }
                    else {
                        $("#modal_custumer_detail").modal('hide')
                        var index = window.current_page
                        get_custumer_list_refresh(index);
                    }

                })


            });


            $('#custumer_list').click(function (e) {
                get_custumer_list_refresh(1)
            });
//-----------------------------告警-------------------------//


            $('#alarm_list').click(function (e) {
                get_alarm_list_refresh(1)
            });
            $("#alarm_deal_commit").click(function (e) {

                var alarmid = $("#td_alarm_id").text();
                var remark = $("#alarmRemark").val();
                var audio = window.alarm_audio;
                var telephone = window.alarm_telephone;
               
                var audiofile = audio + ".wav"; 
                var filename = getFileName($("#file").val());
                if (filename != "" )
                {
                 if( filename != audiofile)
                {
                               console.log(filename + "!= " + audiofile)
                               alert(uploadfile_unmatch)
                               return
                }
                else
                {
                               console.log(filename + "== " + audiofile)
                }
                }
                else
                {
                    if (remark == "")
                     {
                           alert("内容为空")
                           return
                     }
                }
                commit_alarm_record(alarmid, telephone, remark, audio, function (data) {
                    var result = JSON.parse(data);
                    console.log(result);
                    if (result.result == "error") {
                        console.log("增加处理日志失败")
                    }
                    else {
                        //重新刷新用户列表
                        var index = window.current_page
                        get_alarm_list_refresh(index);
                        //上传
                        $("#alarmRemark").val("");
                        
                        ajaxFileUpload('file',function (data, status) {
                                       console.log("upload success " + data.error)
                                       var alarmid = $("#td_alarm_id").text();
                                       fresh_alarm_modal(alarmid);
                                       $('#modal_wait').modal('hide');
                                       $("#alarm_detail").trigger("click")
                                       
                                     })
                        $('#modal_alarm_deal').modal('hide');
                        $("#alarmAlert").attr('style', "display:None");
                        $('#wait').trigger("click")

                    }

                })


            });

            $("#upload_commit").click(function (e) {
                        var filename = getFileName($("#file1").val());
                           
                        if (filename != $("#upload_message").text())
                        {
                               console.log(filename + "!= " + $("#upload_message").text())
                               alert(uploadfile_unmatch)
                               return
                        }

                        //重新刷新用户列表
                        var index = window.current_page
                        get_alarm_list_refresh(index);
                        //上传
                        ajaxFileUpload('file1',function (data, status) {
                                       console.log("upload success" + data.error)
                                       var alarmid = $("#td_alarm_id").text();
                                       fresh_alarm_modal(alarmid);
                                       $('#modal_wait').modal('hide');
                                       $("#alarm_detail").trigger("click")
                                       
                                     })

                        $('#modal_upload').modal('hide');
                        $('#wait').trigger("click")
                })




            $(".call").click(function (e) {
                callup(e)
            })
            $("#hungup").click(function (e) {
                do_hangup(function (data) {
                    console.log("call do_hangup")
                    console.log(data)
                    if(data.msg !="OK"){
                        alert(data.msg)
                    }

                })
            })

            $("#deal_alarm_ok").click(function (e) {
                if ($("#deal_progress").text() == alarm_string[2]) {
                    return
                }
                if ($("#deal_progress").text() == alarm_string [0])
                {
                    alert("没有处理的告警不能关闭")
                    return
                }
                var data = {};
                data.alarmId = $("#td_alarm_id").text()
                $("#deal_alarm_ok").attr("class","btn");
                $("#deal_alarm_ok").attr("disabled", "true");
                release_alarm(data, function (data) {
                    var result = JSON.parse(data);
                    console.log(result);
                    if (result.result == "error") {
                        console.log("解除告警失败")
                    }
                    else {
                        $("#modal_alarm_detail").modal('hide')
                        var index = window.current_page;
                        get_alarm_list_refresh(index);
                        $("#alarmAlert").attr('style', "display:none")

                    }
                })


            })

//----------------------------管理员------------------------//


            $('#add_manage_modal').click(function (e) {
                add_manage($("#inputManageName").val(),
                        $("#inputManageTelephone").val(),
                        $("#inputManagePassword").val(),

                        function (data) {
                            var result = JSON.parse(data);
                            console.log(result);
                            if (result.result == "error") {
                                $("#message_modal_manage").text("增加管理员失败")
                            }
                            else {
                                $('#modal_add_manage').modal('hide');
                                //重新刷新用户列表
                                var index = window.current_page
                                get_manage_list_refresh(index);

                            }
                        });
                // Don't let the link do its natural thing
                e.preventDefault()
            });

            $('#manage_list').click(function (e) {
                get_manage_list_refresh(1)
            });

            $("#update_manage_modal").click(function (e) {
                var data = {}
                data.ManageId = $("#inputManageIdDetail").val();
                data.ManageName = $("#inputManageNameDetail").val();
                data.ManageTelephone = $("#inputManageTelephoneDetail").val();

                console.log(data)
                //发送信息
                update_manage(data, function (data) {
                    var result = JSON.parse(data);
                    console.log(result);
                    if (result.result == "error") {
                        console.log("更新管理员失败")
                    }
                    else {
                        $("#modal_manage_detail").modal('hide')
                        var index = window.current_page;
                        get_manage_list_refresh(index);
                    }

                })


            });

            $("#update_change_modal").click(function (e) {
                var data = {}
                data.ManageId = $("#inputManageIdDetail").val();
                data.ManagePassword = $("#inputManagePasswdDetail").val();

                console.log(data)
                //发送信息
                update_manage_passwd(data, function (data) {
                    var result = JSON.parse(data);
                    console.log(result);
                    if (result.result == "error") {
                        console.log("更新管理员密码失败")
                    }
                    else {
                        $("#modal_change_passwd").modal('hide')
                        var index = window.current_page;
                        get_manage_list_refresh(index);
                    }

                })


            });


            //----------------------日志信息----------//

            $('#record_list').click(function (e) {
                get_record_list_refresh(1)
            });
            //-----------------------------------------//

        });
    </script>
</head>
<body  onload="load()">





    <div class = "self_title" >
        <div class="row">
        <div class="span5">
            <img src="/static/image/login-logo.png" />
        </div>
        <div class="span4">
            <h2>
                监控告警后台管理系统
            </h2>
            </div>
        <div class="span3">
                <h4><span></span><img src="/static/image/user.png"/><span id="manage_index"></span>
                <a class="logout" id="logout_index">退出</a>
                    </h4>
            </div>
        </div>
        </div>



    <div class="row">
        <div class="span1">
        </div>
        <div class="span12">

            <div id="alarmAlert" class="self_alert alert alert-block" style="display: none; ">
                <a href="#" class="close" id="alarm_close">
                    &times;
                </a>
                <strong><img src="/static/image/remind.png"/><span>提醒:<span> </strong>
                <span id="alarm_message"></span>
            </div>


            <iframe id="id_iframe" name="nm_iframe" style="display:none;"></iframe>
            <div class="tabbable" id="tabs-619833">
                <ul class="nav nav-tabs">
                    <li class="active">
                        <a data-toggle="tab" href="#panel-alarm" id="alarm_list">告警列表</a>
                    </li>
                    <li>
                        <a data-toggle="tab" href="#panel-custumer" id="custumer_list">客户列表</a>
                    </li>
                    <li>
                        <a data-toggle="tab" href="#panel-record" id="record_list">日志列表</a>
                    </li>
                    <li>
                        <a data-toggle="tab" href="#panel-manage" id="manage_list" style="display:none">管理员列表</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane active" id="panel-alarm">

                        <div id="modal_wait" class="modal hide fade in" style=" display: none; ">

                            <div class="modal-body">
                                <h4>请等待上传</h4>
                            </div>
                        </div>
                         <p><a data-toggle="modal" href="#modal_wait" class="btn btn-primary"
                              id="wait" style="display: none"></a>
                        </p>

                        <div id="modal_upload" class="modal hide fade in" style=" display: none; ">
                            <div class="modal-header">
                                <a class="close" data-dismiss="modal">×</a>
                                <h3>上传</h3>
                            </div>

                            <div class="modal-body">
                                <h4><span id="select">请选择：</span><span id=upload_message></span></h4>
                                <div>
                                    <input id="file1" name="file" type="file">
                                </div>
                            </div>


                            <div class="modal-footer">
                                <a href="#" class="btn btn-success" id="upload_commit">提交</a>
                                <a href="#" class="btn btn-close" data-dismiss="modal">暂时关闭</a>
                            </div>
                        </div>
                         <p><a data-toggle="modal" href="#modal_upload" class="btn btn-primary"
                              id="upload" style="display: none"></a>
                        </p>

                        <div id="modal_alarm_deal" class="modal hide fade in" style=" display: none; ">
                            <div class="modal-header">
                                <h3>告警处理</h3>
                            </div>

                            <div class="modal-body">
                                <div>
                                <h4 id=deal_message></h4>
                                    </div><div>
                                <h4 id=audiofile_message></h4>
                                </div>
                                <div>
                                <a href="#" class="btn btn-success" id="hungup">挂机</a>
                                </div>
                                <div>
                                <label for="alarmRemark">处理记录</label>
                                <textarea id="alarmRemark" ></textarea>
                                </div>
                                <div>
                                    <input id="file" name="file" type="file">
                                </div>
                            </div>


                            <div class="modal-footer">
                                <a href="#" class="btn btn-success" id="alarm_deal_commit">提交</a>
                                <a href="#" class="btn btn-close" data-dismiss="modal" id="alarm_deal_cancel">暂时关闭</a>
                            </div>
                        </div>
                        <p><a data-toggle="modal" href="#modal_alarm_deal" class="btn btn-primary"
                              id="alarm_deal" style="display: none"></a>
                        </p>
                        <div id="modal_alarm_detail" class="modal hide fade in" style=" display: none; width :800px">
                            <div class="modal-header">
                                <a class="close" data-dismiss="modal">×</a>
                                <h3 id="alarm_title">告警详情</h3>
                            </div>

                            <div class="modal-body">
                                <h3><span id="alarm_id">告警id：</span><span id="td_alarm_id"></span> </h3>
                                <h3><span id="alarm_dev">告警设备：</span><span id="alarm_device"></span> </h3>
                                <h3><span id="deal_person" >处理人：</span><span id="deal_user"></span> <span id="deal_progress_lable"></span><span id="deal_progress"></span></h3>
                                <table class="table table-hover table-condensed" id="modal_alarm_table">
                                    <thead>
                                    <tr>
                                        <th>
                                            告警编号
                                        </th>
                                        <th>
                                            告警类型
                                        </th>
                                        <th>
                                            告警时间
                                        </th>
                                        <th>
                                            告警内容
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>


                                <div class="span">
                                    <div class="span2"><span>火警: </span><a href="#" class="btn call">911</a></div>
                                    <div class="span2"><span>急救: </span><a href="#" class="btn call">120</a></div>
                                    <div class="span2 "><span>漏水: </span><a href="#" class="btn call">111</a></div>
                                    <div class="span2 "><span>漏气: </span><a href="#" class="btn call">112</a></div>
                                    <div class="span4 "><span>主人: </span><a href="#"
                                                                            class="btn call"
                                                                            id="custumer_telephone"></a>
                                    </div>
                                </div>
                                <br/>
                                
                                <div><span class="mylabel" id=user_label>用户: </span>
                                    <div id="custumerName"></div>
                                </div>
                                <div><span class="mylabel" id = addr_label>地址: </span>
                                    <div id="custumerAddress"></div>
                                </div>
                                <div><span class="mylabel" id=remark_label>备注: </span>
                                    <div id="custumerRemark"></div>
                                </div>
                                <br/>


                                <table class="table table-hover table-condensed table-layout:fixed"
                                       id="alarm_table_other">
                                    <thead>
                                    <tr>
                                        <th width="18%">
                                            姓名
                                        </th>
                                        <th width="18%">
                                            口令
                                        </th>
                                        <th width="18%">
                                            家庭电话
                                        </th>
                                        <th width="18%">
                                            工作电话
                                        </th>
                                        <th width="18%">
                                            手机
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                                <table class="table table-hover table-condensed table-layout:fixed"
                                       id="alarm_deal_progress_table">
                                    <thead>
                                    <tr>
                                        <th width="10%">
                                            处理人
                                        </th>
                                        <th width = "18%">
                                            处理电话
                                        </th>
                                        <th width="18%">
                                            处理时间
                                        </th>
                                        <th width="40%">
                                            处理内容
                                        </th>
                                        <th>
                                            附件
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>


                            <div class="modal-footer">
                                <a href="#" class="btn btn-success" id="deal_alarm_ok">处理完成</a>
                                <a href="#" class="btn btn-close" data-dismiss="modal" id="temporary_pause">暂时关闭</a>
                            </div>
                        </div>
                        <p><a data-toggle="modal" href="#modal_alarm_detail" class="btn btn-primary"
                              id="alarm_detail" style="display: none"></a>
                        </p>

                        <table class="table table-hover table-condensed" id="alarm_table">
                            <thead>
                            <tr>
                                <th width="10%">
                                    告警编号
                                </th>
                                <th width="18%">
                                    告警时间
                                </th>
                                <th>
                                    告警内容
                                </th>
                                <th width="10%">
                                    处理阶段
                                </th>
                                <th width="10%">
                                    责任人
                                </th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>

                        <div id="alarm_page" class="pagination" styple="display : none">
                            <ul>

                            </ul>
                        </div>
                        .
                    </div>

                    <div class="tab-pane" id="panel-custumer">

                        <!-- 新增用户详细信息的modal-->
                        <div id="modal_custumer_detail" class="modal hide fade in" style=" display: none; width :800px">
                            <div class="modal-header">
                                <a class="close" data-dismiss="modal">×</a>
                                <h3>客户详情</h3>
                            </div>
                            <div class="modal-body">
                                <div>
                                <label for="inputCustumerIdDetail">客户id</label>
                                <input id="inputCustumerIdDetail" type="text" disabled>
                                    </div>
                                <div>
                                <label for="inputCustumerNameDetail">客户姓名</label>
                                <input id="inputCustumerNameDetail" 
                                       type="text">
                                    </div>
                                <div>
                                <label for="inputCustumerTelephoneDetail">客户电话</label>
                                <input id="inputCustumerTelephoneDetail"
                                       type="text">
                                    </div>
                                <div>
                                <label for="inputCustumerEmailDetail">客户邮箱</label>
                                <input id="inputCustumerEmailDetail" 
                                       type="text">
                                </div>
                                <div>
                                <label for="inputCustumerDeviceidDetail">设备id</label>
                                <input id="inputCustumerDeviceidDetail" 
                                       type="text">

                                </div>
                                <div>
                                  <label for="inputCustumerPhoneDetail">固定电话</label>
                                <input id="inputCustumerPhoneDetail" 
                                       type="text">
                                 </div>
                                <div>
                                  <label for="inputCustumerStateDetail">省/州</label>
                                <select id="inputCustumerStateDetail" > </select>
                                     </div>
                                <div>
                                   <label for="inputCustumerCityDetail">城市</label>
                                    <select id="inputCustumerCityDetail" > </select>
                                     </div>
                                <div>
                                <label for="inputCustumerStreetDetail">地址</label>
                                <input id="inputCustumerStreetDetail" 
                                       type="text">
                                     </div>
                                <div>
                                 <label for="inputCustumerPostelCodeDetail">邮编</label>
                                <input id="inputCustumerPostelCodeDetail" 
                                       type="text">
                                     </div>
                                <div>
                                <label for="inputCustumerRemarkDetail">备注</label>
                        <textarea id="inputCustumerRemarkDetail" 
                        ></textarea>
                                     </div>

                                <p>安防设置计划: （温馨提示：离开时间和到达时间请按照24小时格式！（如：08:00 18:00））</p>
                                <div><span>&emsp;&emsp;&emsp;&emsp;</span><input value="离开时间" type="text" id=leave_time disabled/>
                                    <input value="到达时间" type="text" id=arrive_time disabled/></div>
                                <div><span id="Mon">星期一：</span><input  id="Monleave" type="text">
                                    <input  id="Monreturn" type="text">
                                    </div>
                                <div><span id="Tue">星期二：</span><input id="Tueleave" type="text">
                                    <input id="Tuereturn" type="text">
                                    </div>
                                <div><span id="Wed">星期三：</span><input id="Wedleave" type="text">
                                    <input id="Wedreturn" type="text">
                                    </div>
                                <div><span id="Thu">星期四：</span><input id="Thuleave" type="text">
                                    <input id="Thureturn" type="text">
                                    </div>
                                <div><span id="Fri">星期五：</span><input id="Frileave" type="text">
                                    <input id="Frireturn" type="text">
                                    </div>
                                <div><span id="Sat">星期六：</span><input id="Satleave" type="text">
                                    <input id="Satreturn" type="text">
                                    </div>
                                <div><span id="Sun">星期天：</span><input id="Sunleave" type="text">
                                    <input id="Sunreturn" type="text">
                                    </div>
                                <div><span id=Hol>节假日：</span><input id="Holleave" type="text">
                                    <input id="Holreturn" type="text">
                                    </div>

                                <div id="message_modal_custumer_detail"></div>
                                <table class="table table-hover table-condensed table-layout:fixed"
                                       id="custumer_table_detail">
                                    <thead>
                                    <tr>
                                        <th width="18%">
                                            姓名
                                        </th>
                                        <th width="18%">
                                            口令
                                        </th>
                                        <th width="18%">
                                            家庭电话
                                        </th>
                                        <th width="18%">
                                            工作电话
                                        </th>
                                        <th width="18%">
                                            手机
                                        </th>
                                        <th width="10%">

                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                                <a href="#" class="btn btn-success" id="custumer_add_other">增加</a>
                            </div>

                            <div class="modal-footer">
                                <a href="#" class="btn btn-success" id="update_custumer_modal">修改</a>
                                <a href="#" class="btn btn-close" data-dismiss="modal" id="update_custumer_close">关闭</a>
                            </div>
                        </div>
                        <p><a data-toggle="modal" href="#modal_custumer_detail" class="btn btn-primary"
                              id="custumer_detail" style="display: none"></a>
                        </p>

                        <!-- 新增用户的modal-->
                        <div id="modal_add_custumer" class="modal" style="display: none; ">
                            <div class="modal-header">
                                <a class="close" data-dismiss="modal">×</a>
                                <h3>新增客户</h3>
                            </div>

                            <div class="modal-body">
                                 <div>
                                <label for="inputCustumerName">客户姓名</label>
                                <input id="inputCustumerName"  class="form-control"
                                       type="text">
                                     </div>
                                <div>
                                <label for="inputCustumerTelephone">客户电话</label>
                                <input id="inputCustumerTelephone"
                                       
                                       type="text" >
                                    </div>
                                 <div>
                                <label for="inputCustumerEmail">客户邮箱</label>
                                <input id="inputCustumerEmail" 
                                       type="text">
                                 </div>
                                <div>
                                <label for="inputCustumerDeviceid">设备id</label>
                                <input id="inputCustumerDeviceid" 
                                       type="text">
                                </div>
                                <div>
                                <label for="inputCustumerRemark">备注</label>
                        <textarea id="inputCustumerRemark" 
                        ></textarea>
                                    </div>
                                <div id="message_modal_custumer"></div>

                            </div>
                            <div class="modal-footer">
                                <a href="#" class="btn btn-success" id="add_custumer_modal">增加</a>
                                <a href="#" class="btn btn-close" data-dismiss="modal">关闭</a>
                            </div>
                        </div>
                        <p><a data-toggle="modal" href="#modal_add_custumer" class="btn btn-success"
                              id="add_custumer">新增客户</a>
                        </p>
                        <table class="table table-hover table-condensed table-layout:fixed" id="custumer_table">
                            <thead>
                            <tr>
                                <th width="20%">
                                    客户id
                                </th>
                                <th width="20%">
                                    客户姓名
                                </th>
                                <th width="20%">
                                    客户电话
                                </th>
                                <th>
                                    设备id
                                </th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>


                        <div id="custumer_page" class="pagination" style="display:none">
                            <ul>
                            </ul>
                        </div>
                    </div>

                    <div class="tab-pane" id="panel-record">

                        <!-- 日志信息-->

                        <table class="table table-hover table-condensed table-layout:fixed" id="record_table">
                            <thead>
                            <tr>
                                <th width="18%">
                                    日志id
                                </th>
                                <th width="18%">
                                    操作人
                                </th>
                                <th width="18%">
                                    操作对象
                                </th>
                                <th width="100px">
                                    操作内容
                                </th>
                                <th width="18%">
                                    操作时间
                                </th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>


                        <div id="record_page" class="pagination" style="display:none">
                            <ul>
                            </ul>
                        </div>
                    </div>

                    <div class="tab-pane" id="panel-manage">

                        <!-- 新增管理员详细信息的modal-->
                        <div id="modal_change_passwd" class="modal hide fade in" style=" display: none; ">
                            <div class="modal-header">
                                <a class="close" data-dismiss="modal">×</a>
                                <h3>修改密码</h3>
                            </div>
                            <div class="modal-body">
                                <div>
                                <label for="inputManagePasswdDetail">管理员密码</label>
                                <input id="inputManagePasswdDetail" type="text">
                                    </div>

                            </div>

                            <div class="modal-footer">
                                <a href="#" class="btn btn-success" id="update_change_modal">修改</a>
                                <a href="#" class="btn btn-close" data-dismiss="modal">关闭</a>
                            </div>
                        </div>
                        <div id="modal_manage_detail" class="modal hide fade in" style=" display: none; ">
                            <div class="modal-header">
                                <a class="close" data-dismiss="modal">×</a>
                                <h3>管理员详情</h3>
                            </div>
                            <div class="modal-body">
                                <div>
                                <label for="inputManageIdDetail">管理员id</label>
                                <input id="inputManageIdDetail" type="text" disabled>
                                    </div><div>
                                <label for="inputManageNameDetail">管理员姓名</label>
                                <input id="inputManageNameDetail" 
                                       type="text">
                                </div><div>
                                <label for="inputManageTelephoneDetail">管理员电话</label>
                                <input id="inputManageTelephoneDetail"
                                       type="text">
                                </div>

                                <p><a data-toggle="modal" href="#modal_change_passwd" class="btn btn-success"
                                      id="change_passwd" data-dismiss="modal">修改密码</a></p>
                            </div>


                            <div class="modal-footer">
                                <a href="#" class="btn btn-success" id="update_manage_modal">修改</a>
                                <a href="#" class="btn btn-close" data-dismiss="modal">关闭</a>
                            </div>
                        </div>
                        <p><a data-toggle="modal" href="#modal_manage_detail" class="btn btn-success"
                              id="manage_detail" style="display: none"></a>
                        </p>

                        <!-- 新增管理员的modal-->
                        <div id="modal_add_manage" class="modal" style="display: none; ">
                            <div class="modal-header">
                                <a class="close" data-dismiss="modal">×</a>
                                <h3>新增管理员</h3>
                            </div>

                            <div class="modal-body">
                                <div>
                                <label for="inputManageName">管理员姓名</label>
                                <input id="inputManageName" class="form-control"
                                       type="text">
                                    </div><div>
                                <label for="inputManageTelephone">管理员电话</label>
                                <input id="inputManageTelephone"
                                       
                                       type="text">
                                </div><div>
                                <label for="inputManagePassword">管理员密码</label>
                                <input id="inputManagePassword" 
                                       type="text">
                                </div>

                                <div id="message_modal_manage"></div>

                            </div>
                            <div class="modal-footer">
                                <a href="#" class="btn btn-success" id="add_manage_modal">增加</a>
                                <a href="#" class="btn btn-close" data-dismiss="modal">关闭</a>
                            </div>
                        </div>
                        <p><a data-toggle="modal" href="#modal_add_manage" class="btn btn-success"
                              id="add_manage">新增管理员</a>
                        </p>
                        <table class="table table-hover table-condensed table-layout:fixed" id="manage_table">
                            <thead>
                            <tr>
                                <th width="20%">
                                    管理员id
                                </th>
                                <th width="20%">
                                    管理员姓名
                                </th>
                                <th width="20%">
                                    管理员电话
                                </th>
                                <th>
                                    最后登录时间
                                </th>

                                <th>
                                    最后登出时间
                                </th>

                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>


                        <div id="manage_page" class="pagination" style="display:none">
                            <ul>
                            </ul>
                        </div>
                    </div>


                </div>
            </div>

        </div>
        <div class="span1">
        </div>
    </div>

    <div class = "self_foot">
        <div class="row">
            <span>技术支持：深圳经纬纵横科技有限公司</span></div></div>



</body>


</html>

